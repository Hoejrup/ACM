<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Monte Carlo - Simlation package • ACM</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Monte Carlo - Simlation package">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ACM</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Vignette.html">Monte Carlo - Simlation package</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Monte Carlo - Simlation package</h1>
                        <h4 class="author">By Anders Højrup, Markus Legat &amp; Christian Skalborg Jensen</h4>
            
            <h4 class="date">November 2019</h4>
      
      
      <div class="hidden name"><code>Vignette.Rmd</code></div>

    </div>

    
    
<div id="functions-included-in-the-package" class="section level1">
<h1 class="hasAnchor">
<a href="#functions-included-in-the-package" class="anchor"></a>Functions included in the package</h1>
<pre><code>## Loading required package: ggplotify</code></pre>
<pre><code>## Loading required package: gridExtra</code></pre>
<pre><code>## 
## Attaching package: 'ACM'</code></pre>
<pre><code>## The following object is masked from 'package:utils':
## 
##     data</code></pre>
<div id="arsim" class="section level2">
<h2 class="hasAnchor">
<a href="#arsim" class="anchor"></a>ARsim( )</h2>
<p>The function <code><a href="../reference/ARsim.html">ARsim()</a></code> draws from the random variable, which is specified by the density <span class="math inline">\(f\)</span>, using acceptance rejection sampling. The default proposal density is the exponential density with rate 1. If you want to use a different density you have to set the argument “exponential” to FALSE and specify your new proposal density and the corresponding inverse distribution function. Don’t forget to find an appropriate <span class="math inline">\(C\)</span> such that <span class="math inline">\(f(x) \leq C*g(x)\)</span>.</p>
<p>Let’s look at an example:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">C &lt;-<span class="st"> </span><span class="fl">1.6</span></a>
<a class="sourceLine" id="cb5-2" data-line-number="2">lambda &lt;-<span class="st"> </span><span class="fl">0.5</span></a>
<a class="sourceLine" id="cb5-3" data-line-number="3">f &lt;-<span class="st"> </span><span class="cf">function</span>(x) {x<span class="op">*</span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">exp</a></span>(<span class="op">-</span>x)}</a>
<a class="sourceLine" id="cb5-4" data-line-number="4"></a>
<a class="sourceLine" id="cb5-5" data-line-number="5">ARsimulation &lt;-<span class="st"> </span><span class="kw"><a href="../reference/ARsim.html">ARsim</a></span>(f, C, <span class="dv">100000</span>, <span class="dt">rate =</span> lambda)</a></code></pre></div>
<p>The class of output of <code><a href="../reference/ARsim.html">ARsim()</a></code> is “AR”. We therefore added sepecified methods for plotting and also a summary function.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(ARsimulation, <span class="dt">ggplot =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<p><img src="Vignette_files/figure-html/unnamed-chunk-3-1.png" width="768"></p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(ARsimulation)</a></code></pre></div>
<pre><code>## [1] "1e+05 samples from the random variable, specified by the target density via acceptance rejection sampling."</code></pre>
</div>
<div id="inv_sample" class="section level2">
<h2 class="hasAnchor">
<a href="#inv_sample" class="anchor"></a>inv_sample( )</h2>
<p>The function <code><a href="../reference/inv_sample.html">inv_sample()</a></code> draws from the random variable, which is specified by the distribution F, using inverse sampling.</p>
<p>For this purpose, we define the inverse distribution function, we want to sample from. Addtionally, we define the classical distribution function to use some special features of the plot method for objects of the class “invsample”.</p>
<p>Lets take a look at an example again:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1">Finv &lt;-<span class="st"> </span><span class="cf">function</span>(x){<span class="op">-</span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(<span class="dv">1</span><span class="op">-</span>x)}</a>
<a class="sourceLine" id="cb9-2" data-line-number="2">F_dist &lt;-<span class="st"> </span><span class="cf">function</span>(x){<span class="dv">1</span><span class="op">-</span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">exp</a></span>(<span class="op">-</span>x)}</a>
<a class="sourceLine" id="cb9-3" data-line-number="3"></a>
<a class="sourceLine" id="cb9-4" data-line-number="4">inv_samples &lt;-<span class="st"> </span><span class="kw"><a href="../reference/inv_sample.html">inv_sample</a></span>(Finv, <span class="dt">N =</span> <span class="dv">10000</span>)</a>
<a class="sourceLine" id="cb9-5" data-line-number="5">inv_samples_withF &lt;-<span class="st"> </span><span class="kw"><a href="../reference/inv_sample.html">inv_sample</a></span>(Finv, <span class="dt">N =</span> <span class="dv">10000</span>, <span class="dt">F_distribution =</span> F_dist)</a>
<a class="sourceLine" id="cb9-6" data-line-number="6"></a>
<a class="sourceLine" id="cb9-7" data-line-number="7"><span class="kw"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(inv_samples_withF)</a></code></pre></div>
<pre><code>## [1] "10000 samples from the random variable, specified by the inverse distribution via inverse sampling."</code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(inv_samples, <span class="dt">ggplot =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<p><img src="Vignette_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(inv_samples_withF, <span class="dt">ggplot =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<p><img src="Vignette_files/figure-html/unnamed-chunk-6-1.png" width="480"></p>
</div>
<div id="int" class="section level2">
<h2 class="hasAnchor">
<a href="#int" class="anchor"></a>int( )</h2>
<p>The function <code><a href="../reference/int.html">int()</a></code> performs a Monte Carlo integration of the function f.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1">f &lt;-<span class="st"> </span><span class="cf">function</span>(x){x<span class="op">^</span><span class="dv">2</span>}</a>
<a class="sourceLine" id="cb13-2" data-line-number="2">MCint &lt;-<span class="st"> </span><span class="kw"><a href="../reference/int.html">int</a></span>(f, <span class="dv">-2</span>, <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb13-3" data-line-number="3">MCint<span class="op">$</span><span class="st">'Value of integral'</span></a></code></pre></div>
<pre><code>## [1] 5.31494</code></pre>
<p>We would like to compare the sampled value to the theoretical one. It holds that: <span class="math display">\[\int_{-2}^{2}f(x)dx = \int_{-2}^{2}x^2dx = \left[\frac{x^3}{3}\right]^{x=2}_{x=-2} = 2\frac{8}{3} \]</span></p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1">(theoretical_value &lt;-<span class="st"> </span><span class="dv">16</span><span class="op">/</span><span class="dv">3</span>)</a></code></pre></div>
<pre><code>## [1] 5.333333</code></pre>
<p>Calling the plot and the summary method yields:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(MCint)</a></code></pre></div>
<pre><code>## [1] "By Monte Carlo integration, the integral of the function f from -2 to 2 was evaluated, yielding the value 5.31493969726341 . The corresponding asymptotic 0.95-confidence interval is given by [ 5.2854918798044 , 5.34438751472243 ]"</code></pre>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(MCint, <span class="dt">ggplot =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<p><img src="Vignette_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
</div>
<div id="plot-copula" class="section level2">
<h2 class="hasAnchor">
<a href="#plot-copula" class="anchor"></a>plot.copula( )</h2>
<p>The plot.copula() function creates a plot of a 2 dimensional copula, using the empirical CDF. This is done by a rank transformation. This is an example of a copula for a 1-Fréchet (inverse Weibull) distribution.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" data-line-number="1"><span class="co">#Example using 1-Fréchet</span></a>
<a class="sourceLine" id="cb20-2" data-line-number="2">N &lt;-<span class="st"> </span><span class="dv">10000</span></a>
<a class="sourceLine" id="cb20-3" data-line-number="3">R &lt;-<span class="st"> </span><span class="dv">-1</span><span class="op">/</span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(<span class="kw"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span>(N))</a>
<a class="sourceLine" id="cb20-4" data-line-number="4">U &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span>(N)</a>
<a class="sourceLine" id="cb20-5" data-line-number="5">X &lt;-<span class="st"> </span>R<span class="op">*</span>U</a>
<a class="sourceLine" id="cb20-6" data-line-number="6">Y &lt;-<span class="st"> </span>R<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>U)</a>
<a class="sourceLine" id="cb20-7" data-line-number="7">data &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(X,Y),<span class="dt">ncol=</span><span class="dv">2</span>)</a></code></pre></div>
<p>We can set the class of data to be of class copula, then we can use the generic plot function.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/class.html">class</a></span>(data) &lt;-<span class="st"> 'copula'</span></a>
<a class="sourceLine" id="cb21-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(data, <span class="dt">ggplot=</span>T)</a></code></pre></div>
<p><img src="Vignette_files/figure-html/unnamed-chunk-11-1.png" width="700"></p>
</div>
<div id="plot-simulation" class="section level2">
<h2 class="hasAnchor">
<a href="#plot-simulation" class="anchor"></a>plot.simulation( )</h2>
<p>Generates the plot of the mean and confidence interval.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" data-line-number="1">x &lt;-<span class="st"> </span>MC_pi</a>
<a class="sourceLine" id="cb22-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(x, <span class="dt">ggplot =</span> T)</a></code></pre></div>
<p><img src="Vignette_files/figure-html/unnamed-chunk-12-1.png" width="700"></p>
</div>
<div id="rbi_norm" class="section level2">
<h2 class="hasAnchor">
<a href="#rbi_norm" class="anchor"></a>rbi_norm( )</h2>
<p>The function rbi_norm() generates a bivariate normal distribution. Example</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" data-line-number="1">data &lt;-<span class="st"> </span><span class="kw"><a href="../reference/rbi_norm.html">rbi_norm</a></span>(<span class="dt">N=</span><span class="dv">1000</span>, <span class="dt">rho=</span><span class="fl">0.7</span>)</a></code></pre></div>
<p>If unspecified, it will default as rbi_norm(N=10^5, rho, mean=0, var=1).</p>
</div>
<div id="simulation_analysis" class="section level2">
<h2 class="hasAnchor">
<a href="#simulation_analysis" class="anchor"></a>Simulation_analysis( )</h2>
<p>Creates a simple PDF analysis by combining plot and summary for a simulation vector. PDF is saved in current working directory</p>
</div>
<div id="summary-simulation" class="section level2">
<h2 class="hasAnchor">
<a href="#summary-simulation" class="anchor"></a>summary.simulation( )</h2>
<p>Returns a list of mean, variance, relative error and confidence interval.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" data-line-number="1">x &lt;-<span class="st"> </span>MC_pi</a>
<a class="sourceLine" id="cb24-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(x, <span class="dt">print =</span> F)</a></code></pre></div>
<pre><code>## $Mean
## [1] 3.1398
## 
## $Variance
## [1] 2.7008
## 
## $`Relative Error`
## [1] 0.001
## 
## $`Confidence interval`
## [1] "[ 3.1345 ; 3.1451 ]"</code></pre>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li>
<a href="#functions-included-in-the-package">Functions included in the package</a><ul class="nav nav-pills nav-stacked">
<li><a href="#arsim">ARsim( )</a></li>
      <li><a href="#inv_sample">inv_sample( )</a></li>
      <li><a href="#int">int( )</a></li>
      <li><a href="#plot-copula">plot.copula( )</a></li>
      <li><a href="#plot-simulation">plot.simulation( )</a></li>
      <li><a href="#rbi_norm">rbi_norm( )</a></li>
      <li><a href="#simulation_analysis">Simulation_analysis( )</a></li>
      <li><a href="#summary-simulation">summary.simulation( )</a></li>
      </ul>
</li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by The package maintainer.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
